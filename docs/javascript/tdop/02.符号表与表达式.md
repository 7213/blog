# 符号与表达式
## 符号表
在[上一篇中](/javascript/tdop/01.词法和语法.md)解析出了词法单元，每种词法单元有不同的语法解析规则，所以需要一种数据结构(symbol)对应*操作符*、*字面量*、*结束符*等词法单元来内聚不同解析逻辑。    
在TDOP中，TD代表自顶向下，OP代表算符优先。   
TD是从词法流开始位置作为解析起点，逐步遇到"符号"使用(symbol)定义的语法规则进行解析，其中当遇到操作符(表达式、语句等)使用OP的nud、led和bp（绑定权重）规则进行正确拆解（算符优先级的匹配，如正确解析出1+2*3的优先级），期间词法单元会逐步前进(advance)当解析完词法单元流后也就完成了语法校验和AST的生成。   
符号表用来存放定义符号的Map。



- 符号
```javascript
var original_symbol = {
    nud: function () {
        this.error("Undefined.");
    },
    led: function (ignore) {
        this.error("Missing operator.");
    }
};
var symbol = function (id, bp) {
    var s = symbol_table[id];
    bp = bp || 0;
    if (s) {
        if (bp >= s.lbp) {
            s.lbp = bp;
        }
    } else {
        s = Object.create(original_symbol);
        s.id = id;
        s.value = id;
        s.lbp = bp;
        symbol_table[id] = s; // 放到符号表中
    }
    return s;
};
```

- 符号表
```javascript
var symbol_table = {};
```


符号是一个具有nud和led方法的JS对象，

```javascript

```
